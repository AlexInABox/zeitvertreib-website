<div class="profile-page">
  <!-- Loading State -->
  <div *ngIf="!currentUser" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Lade Profildaten...</p>
  </div>

  <div *ngIf="currentUser" class="profile-wrapper">
    <!-- Profile Card -->
    <div class="card profile-card">
      <div class="card-header">
        <span class="card-icon">ğŸ‘¤</span>
        <div class="card-title-group">
          <h2>Profil</h2>
          <span class="card-subtitle">Deine Account-Informationen</span>
        </div>
      </div>
      <div class="profile-content">
        <img [src]="currentUser.avatarUrl" [alt]="currentUser.username" class="avatar" />
        <div class="profile-info">
          <span class="username">{{ currentUser.username }}</span>
          <span class="steamid">{{ currentUser.steamId }}</span>
        </div>
        <button class="btn btn-danger" (click)="logout()"><span>ğŸšª</span> Abmelden</button>
      </div>
    </div>

    <!-- Sessions Card -->
    <div class="card sessions-card">
      <div class="card-header">
        <span class="card-icon">ğŸ”</span>
        <div class="card-title-group">
          <h2>Aktive Sitzungen</h2>
          <span class="card-subtitle">Verwalte deine aktiven GerÃ¤te</span>
        </div>
        <span *ngIf="sessions.length > 0" class="badge">{{ sessions.length }}</span>
      </div>

      <!-- Loading -->
      <div *ngIf="loadingSessions" class="card-loading">
        <div class="loading-spinner small"></div>
        <span>Lade Sitzungen...</span>
      </div>

      <!-- Sessions Content -->
      <div *ngIf="!loadingSessions && sessions.length > 0" class="sessions-content">
        <button class="ip-toggle" (click)="toggleIps()">
          {{ showIps ? 'ğŸ™ˆ IPs verbergen' : 'ğŸ‘ï¸ IPs anzeigen' }}
        </button>

        <div class="sessions-list">
          <div
            *ngFor="let session of sessions"
            class="session-row"
            [class.current]="isCurrentSession(session.id)"
            [class.stale]="!isCurrentSession(session.id) && isStale(session.lastLoginAt)"
          >
            <span class="session-icon">{{ getDeviceIcon(session.userAgent) }}</span>
            <div class="session-details">
              <div class="session-main">
                <span class="session-browser">{{ getBrowserName(session.userAgent) }}</span>
                <span *ngIf="isCurrentSession(session.id)" class="tag tag-current">Aktuell</span>
                <span *ngIf="!isCurrentSession(session.id) && isStale(session.lastLoginAt)" class="tag tag-stale"
                  >Inaktiv</span
                >
              </div>
              <span class="session-ip">{{ getIpDisplay(session.ipAddress) }}</span>
              <div class="session-time">
                <span [class.text-warning]="isStale(session.lastLoginAt)">{{
                  getRelativeTime(session.lastLoginAt)
                }}</span>
                <span class="dot">Â·</span>
                <span>{{ formatDate(session.createdAt) }}</span>
              </div>
            </div>
            <button
              *ngIf="!isCurrentSession(session.id)"
              class="btn-icon-only btn-revoke"
              (click)="revokeSession(session.id)"
              [disabled]="revokingSession === session.id"
              title="Sitzung beenden"
            >
              <span *ngIf="revokingSession !== session.id">ğŸ—‘ï¸</span>
              <span *ngIf="revokingSession === session.id" class="loading-spinner tiny"></span>
            </button>
          </div>
        </div>
      </div>

      <!-- Empty -->
      <div *ngIf="!loadingSessions && sessions.length === 0" class="card-empty">
        <span>ğŸ”’</span>
        <span>Keine aktiven Sitzungen</span>
      </div>
    </div>

    <!-- Data Management Card -->
    <div class="card data-card">
      <div class="card-header">
        <span class="card-icon">ğŸ“Š</span>
        <div class="card-title-group">
          <h2>Datenverwaltung</h2>
          <span class="card-subtitle">Kontrolliere deine persÃ¶nlichen Daten</span>
        </div>
      </div>
      <div class="data-buttons">
        <button class="data-btn" disabled>
          <span class="data-btn-icon">ğŸ“¥</span>
          <div class="data-btn-text">
            <span class="data-btn-title">Daten exportieren</span>
            <span class="data-btn-desc">Lade alle deine Daten herunter</span>
          </div>
          <span class="tag tag-soon">DemnÃ¤chst</span>
        </button>
        <button class="data-btn data-btn-danger" disabled>
          <span class="data-btn-icon">ğŸ—‘ï¸</span>
          <div class="data-btn-text">
            <span class="data-btn-title">Account lÃ¶schen</span>
            <span class="data-btn-desc">LÃ¶sche alle deine Daten permanent</span>
          </div>
          <span class="tag tag-soon">DemnÃ¤chst</span>
        </button>
      </div>
    </div>
  </div>
</div>
