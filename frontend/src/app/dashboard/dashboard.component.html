<div class="dashboard-container">
  <div class="grid grid-cols-3 gap-4 p-6 dashboard-grid relative z-10">
    <!-- Loading State -->
    <div
      *ngIf="isLoading"
      class="col-span-3 flex items-center justify-center min-h-96"
    >
      <div class="text-center text-white">
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="text-xl font-medium">Lade Statistiken...</p>
      </div>
    </div>

    <!-- Error State -->
    <div
      *ngIf="hasError && !isLoading"
      class="col-span-3 flex items-center justify-center min-h-96"
    >
      <div class="error-message max-w-md">
        <h3 class="text-xl font-bold mb-2">Fehler beim Laden</h3>
        <p class="mb-4">{{ errorMessage }}</p>
        <button (click)="refreshStats()" class="refresh-button">
          Erneut versuchen
        </button>
      </div>
    </div>

    <!-- Main Content -->
    <ng-container *ngIf="!isLoading && !hasError">
      <!-- Stats Overview -->
      <div class="col-span-2 stats-overview">
        <div class="stats-card p-6 rounded-2xl auto-height">
          <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
            <!-- Kills -->
            <div
              class="stat-item"
              style="--stat-color: #10b981; --stat-color-light: #34d399"
            >
              <div class="stat-indicator"></div>
              <div class="flex-1 min-w-0 ml-4 flex flex-col justify-center">
                <h5 class="stat-label m-0 mb-1">AbschÃ¼sse</h5>
                <p class="stat-value m-0">
                  {{ userStatistics.kills | number: '1.0-0' }}
                </p>
              </div>
            </div>

            <!-- Deaths -->
            <div
              class="stat-item"
              style="--stat-color: #3b82f6; --stat-color-light: #60a5fa"
            >
              <div class="stat-indicator"></div>
              <div class="flex-1 min-w-0 ml-4 flex flex-col justify-center">
                <h5 class="stat-label m-0 mb-1">TodesfÃ¤lle</h5>
                <p class="stat-value m-0">
                  {{ userStatistics.deaths | number: '1.0-0' }}
                </p>
              </div>
            </div>

            <!-- Experience -->
            <div
              class="stat-item"
              style="--stat-color: #f59e0b; --stat-color-light: #fbbf24"
            >
              <div class="stat-indicator"></div>
              <div class="flex-1 min-w-0 ml-4 flex flex-col justify-center">
                <h5 class="stat-label m-0 mb-1">Erfahrung</h5>
                <p class="stat-value m-0">
                  {{ userStatistics.experience | number: '1.0-0' }}XP
                </p>
              </div>
            </div>

            <!-- K/D Ratio -->
            <div
              class="stat-item"
              style="--stat-color: #8b5cf6; --stat-color-light: #a78bfa"
            >
              <div class="stat-indicator"></div>
              <div class="flex-1 min-w-0 ml-4 flex flex-col justify-center">
                <h5 class="stat-label m-0 mb-1">K/D Ratio</h5>
                <p class="stat-value m-0">
                  {{ kdRatio }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Player Card -->
      <div class="col-span-1 player-card-container">
        <div class="player-card">
          <!-- Avatar Header -->
          <div
            class="player-avatar-container"
            *ngIf="userStatistics?.avatarFull"
          >
            <img
              class="player-avatar"
              [src]="getAvatarUrl(userStatistics.avatarFull)"
              [alt]="userStatistics.username || 'Player Avatar'"
              loading="lazy"
              (error)="onImageError($event)"
            />
          </div>

          <!-- Player Info -->
          <div class="p-6">
            <h2 class="text-2xl font-bold text-white mb-2 cardHeader">
              Willkommen zurÃ¼ck,<br />
              <span class="text-gradient">{{
                userStatistics.username || 'Spieler'
              }}</span>
            </h2>

            <p class="text-lg text-gray-300 mb-6">
              {{ leaderboardText }}
            </p>

            <!-- Stats List -->
            <div class="space-y-3">
              <div class="player-info-item">
                <span class="player-info-label">Gespielte Runden:</span>
                <span class="player-info-value">{{
                  userStatistics.roundsplayed | number: '1.0-0'
                }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Spielzeit:</span>
                <span class="player-info-value">{{ playtimeFormatted }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Benutzte Medkits:</span>
                <span class="player-info-value">{{
                  userStatistics.usedmedkits | number: '1.0-0'
                }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Getrunkene Colas:</span>
                <span class="player-info-value">{{
                  userStatistics.usedcolas | number: '1.0-0'
                }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Pocket Escapes:</span>
                <span class="player-info-value">{{
                  userStatistics.pocketescapes | number: '1.0-0'
                }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Benutzte Adrenalin:</span>
                <span class="player-info-value">{{
                  userStatistics.usedadrenaline | number: '1.0-0'
                }}</span>
              </div>

              <div class="player-info-item">
                <span class="player-info-label">Snake Highscore:</span>
                <span class="player-info-value">{{
                  userStatistics.snakehighscore | number: '1.0-0'
                }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Custom Spray Card -->
      <div class="col-span-1 spray-card-container">
        <div class="stats-card p-6 rounded-2xl auto-height">
          <!-- Help Popup (replaces entire card content when shown) -->
          <div *ngIf="showSprayHelp" class="help-popup h-full">
            <div class="help-content h-full">
              <div class="help-title">
                Custom Spray - Dein persÃ¶nliches Zeichen! ğŸ¨
              </div>
              <div class="help-text">
                Mit einem Custom Spray kannst du dein eigenes Bild als
                persÃ¶nliches Zeichen im Spiel verwenden.
              </div>
              <div class="help-text">
                <strong>Wie funktioniert es?</strong><br />
                â€¢ Lade ein beliebiges Bild oder GIF hoch<br />
                â€¢ PNG/JPG bis 10MB, GIFs bis 2MB (max. 20 Frames)<br />
                â€¢ Das Bild wird automatisch optimiert und ins Spiel
                Ã¼bertragen<br />
                â€¢ Nutze es, um WÃ¤nde oder OberflÃ¤chen zu markieren
              </div>
              <div class="help-text">
                <strong>Tipp:</strong> Einfache Designs und klare Formen
                funktionieren am besten! GIFs werden animiert dargestellt.
              </div>
              <button (click)="showSprayHelp = false" class="help-close-btn">
                Verstanden! âœ¨
              </button>
            </div>
          </div>

          <!-- Regular Card Content -->
          <div *ngIf="!showSprayHelp">
            <h3
              class="text-xl font-bold text-white flex items-center justify-between cardHeader"
            >
              <div class="flex items-center gap-2">
                ğŸ¨ <span>Custom Spray</span>
              </div>
              <button
                (click)="showSprayHelp = true"
                class="help-button"
                title="Hilfe anzeigen"
              >
                ?
              </button>
            </h3>

            <!-- Current Spray Display -->
            <div *ngIf="hasSpray" class="current-spray mb-4 text-center">
              <div class="spray-preview-container mx-auto relative">
                <div class="spray-preview">
                  <img
                    [src]="currentSprayImage"
                    alt="Current Spray"
                    class="spray-image"
                  />
                </div>
                <button
                  (click)="removeSpray()"
                  class="remove-spray-button"
                  [disabled]="sprayUploadLoading"
                  title="Spray lÃ¶schen"
                >
                  Ã—
                </button>
              </div>
            </div>

            <!-- No Spray State -->
            <div *ngIf="!hasSpray && !selectedFile" class="text-center py-4">
              <div class="text-4xl mb-2">ğŸ¨</div>
              <p class="text-gray-300 text-sm">Kein Spray hochgeladen</p>
            </div>

            <!-- Upload Section with Drag & Drop -->
            <div class="spray-upload">
              <div
                class="upload-area"
                [class.has-file]="selectedFile && !sprayUploadLoading"
                [class.loading]="sprayUploadLoading"
                [class.drag-over]="isDragOver"
                (dragover)="onDragOver($event)"
                (dragleave)="onDragLeave($event)"
                (drop)="onDrop($event)"
              >
                <input
                  type="file"
                  id="sprayFileInput"
                  accept="image/*"
                  (change)="onFileSelected($event)"
                  class="file-input"
                />
                <label for="sprayFileInput" class="upload-label">
                  <div class="upload-content">
                    <div
                      *ngIf="!sprayUploadLoading && !selectedFile"
                      class="text-center"
                    >
                      <div class="text-2xl mb-2">ğŸ“</div>
                      <p class="font-medium">Klicken oder hierher ziehen</p>
                      <p class="text-sm opacity-75">PNG, JPG, GIF</p>
                      <p class="text-xs opacity-60 mt-1">
                        Max: 10MB (Bilder) / 2MB (GIFs, 20 Frames)
                      </p>
                    </div>
                    <div
                      *ngIf="selectedFile && !sprayUploadLoading"
                      class="text-center"
                    >
                      <div class="text-2xl mb-2">âœ“</div>
                      <p class="font-medium">{{ selectedFileName }}</p>
                      <p class="text-sm opacity-75">Bereit zum Upload</p>
                    </div>
                    <div *ngIf="sprayUploadLoading" class="text-center">
                      <div class="loading-spinner mx-auto mb-2"></div>
                      <p class="font-medium">Wird hochgeladen...</p>
                    </div>
                  </div>
                </label>
              </div>

              <div
                *ngIf="selectedFile && !sprayUploadLoading"
                class="upload-actions mt-3"
              >
                <button (click)="uploadSpray()" class="upload-button">
                  Hochladen
                </button>
                <button (click)="selectedFile = null" class="cancel-button">
                  Abbrechen
                </button>
              </div>
            </div>

            <!-- Privacy Policy Notice -->
            <div
              class="privacy-warning mt-4 bg-yellow-900/30 border border-yellow-500/50 rounded-lg"
            >
              <!-- Compact Default State -->
              <div
                *ngIf="!showPrivacyDetails"
                class="flex items-center gap-3 p-4 md:p-5"
              >
                <div class="text-yellow-400 text-xl leading-none">âš ï¸</div>
                <div class="text-sm text-yellow-100 leading-relaxed">
                  <strong>Datenschutzhinweis:</strong>
                  <span
                    class="text-yellow-300 underline decoration-yellow-400/70 hover:text-yellow-200 cursor-pointer ml-1"
                    (click)="showPrivacyDetails = true"
                    >Details anzeigen
                  </span>
                </div>
              </div>

              <!-- Expanded Privacy Details -->
              <div
                *ngIf="showPrivacyDetails"
                id="privacy-details"
                class="privacy-expanded p-4 md:p-5"
              >
                <div class="flex items-start gap-3 mb-3">
                  <div class="text-yellow-400 text-xl leading-none">âš ï¸</div>
                  <h4
                    class="text-sm md:text-base font-semibold text-yellow-100 flex-1 cardHeader"
                  >
                    Datenschutzhinweis - Wichtige Informationen
                  </h4>

                  <span
                    class="privacy-close-btn text-yellow-300 hover:text-yellow-200 text-xs md:text-sm cursor-pointer"
                    (click)="showPrivacyDetails = false"
                    title="SchlieÃŸen"
                    role="button"
                    aria-label="Datenschutzhinweis schlieÃŸen"
                    aria-expanded="true"
                    aria-controls="privacy-details"
                  >
                    âœ•
                  </span>
                </div>

                <ul class="privacy-list text-sm text-yellow-100 space-y-3 pl-1">
                  <li class="leading-relaxed">
                    <span class="font-semibold"
                      >Ã–ffentliche VerfÃ¼gbarkeit und DatenÃ¼bertragung:</span
                    >
                    Ihr hochgeladenes Bild wird Ã¶ffentlich zugÃ¤nglich und kann
                    an unseren Discord-Server Ã¼bertragen werden, welcher auf
                    US-amerikanischen Servern auÃŸerhalb unserer direkten
                    Kontrolle gehostet wird. Diese Ãœbertragung erfolgt zur
                    technischen Bereitstellung des Services.
                  </li>

                  <li class="leading-relaxed">
                    <span class="font-semibold"
                      >DatenlÃ¶schung und Persistenz:</span
                    >
                    Eine LÃ¶schung des Bildes durch Sie garantiert nicht die
                    vollstÃ¤ndige und endgÃ¼ltige Entfernung von unseren Systemen,
                    Discord-Servern oder beteiligten Drittsystemen. Kopien
                    kÃ¶nnen in Backups, Caches oder anderen technischen Systemen
                    verbleiben.
                  </li>

                  <li class="leading-relaxed">
                    <span class="font-semibold"
                      >Automatisierte Inhaltsmoderation:</span
                    >
                    Alle hochgeladenen Bilder werden automatisiert mittels
                    OpenAI-Moderation (Modell â€omni-moderation-latestâ€œ) geprÃ¼ft.
                    Dabei kÃ¶nnen Ihre Bilddaten an OpenAI Ã¼bermittelt werden.
                    Die Verarbeitung erfolgt zur Erkennung und Vermeidung
                    unzulÃ¤ssiger Inhalte.
                  </li>

                  <li class="leading-relaxed">
                    <span class="font-semibold"
                      >ModerationsmaÃŸnahmen und Account-Sperrung:</span
                    >
                    Wir behalten uns vor, hochgeladene Bilder jederzeit und ohne
                    VorankÃ¼ndigung zu lÃ¶schen. Bei VerstÃ¶ÃŸen gegen diese
                    Hinweise, gegen gesetzliche Vorgaben oder bei
                    missbrÃ¤uchlicher Nutzung kann Ihr Account ohne vorherige
                    Warnung gesperrt werden.
                  </li>

                  <li class="leading-relaxed">
                    <span class="font-semibold"
                      >Internationale DatenÃ¼bertragung:</span
                    >
                    Durch die Nutzung von Discord-Servern und die Einbindung des
                    OpenAI-Moderationsdienstes kann eine Ãœbertragung Ihrer Daten
                    in die USA und ggf. weitere DrittlÃ¤nder erfolgen, in denen
                    ein anderes Datenschutzniveau als in Deutschland/EU gilt.
                  </li>

                  <li class="leading-relaxed font-semibold p-2 rounded">
                    <span class="font-semibold">EinverstÃ¤ndniserklÃ¤rung:</span>
                    Durch das Hochladen eines Bildes erklÃ¤ren Sie sich mit den
                    oben genannten Bedingungen einverstanden und bestÃ¤tigen,
                    dass Sie die rechtlichen Konsequenzen verstanden haben.
                  </li>
                </ul>
              </div>
            </div>

            <!-- Messages -->
            <div *ngIf="sprayUploadError" class="error-message mt-3">
              {{ sprayUploadError }}
            </div>
            <div *ngIf="sprayUploadSuccess" class="success-message mt-3">
              Spray erfolgreich hochgeladen!
            </div>
            <div *ngIf="sprayDeleteSuccess" class="success-message mt-3">
              Spray erfolgreich gelÃ¶scht!
            </div>
          </div>
        </div>
      </div>

      <!-- Fakerank Card -->
      <div class="col-span-1">
        <div id="fakerank-card" class="stats-card p-6 rounded-2xl auto-height">
          <!-- Help Popup (replaces entire card content when shown) -->
          <div *ngIf="showFakerankHelp" class="help-popup h-full">
            <div class="help-content h-full">
              <div class="help-title">
                Fakerank - Dein persÃ¶nlicher Spitzname! âœ¨
              </div>
              <div class="help-text">
                Ein Fakerank ist einfach ein cooler Spitzname, den du dir selbst
                geben kannst! Es hat nichts mit deinem echten Rang im Spiel zu
                tun - es ist nur zur Dekoration und macht dein Profil
                persÃ¶nlicher.
              </div>
              <div class="help-text">
                <strong>Wann kannst du es nutzen?</strong><br />
                Jederzeit! Sei kreativ - ob "Pizza Liebhaber", "Sniper Pro" oder
                "Chaos KÃ¶nig" - es ist dein persÃ¶nlicher Touch.
              </div>
              <div class="help-text">
                <strong>Tipp:</strong> WÃ¤hle etwas, das deine PersÃ¶nlichkeit
                oder deinen Spielstil widerspiegelt. Andere Spieler werden es
                sehen kÃ¶nnen!
              </div>
              <button (click)="showFakerankHelp = false" class="help-close-btn">
                Verstanden! âœ¨
              </button>
            </div>
          </div>

          <!-- Regular Card Content -->
          <div *ngIf="!showFakerankHelp">
            <h3
              class="text-xl font-bold text-white mb-4 flex items-center gap-2 justify-between cardHeader"
            >
              <div class="flex items-center gap-2">
                âœ¨ <span>Fakerank</span>
              </div>
              <button
                (click)="showFakerankHelp = true"
                class="help-button"
                title="Was ist ein Fakerank?"
              >
                ?
              </button>
            </h3>

            <!-- Display Mode -->
            <div *ngIf="!isEditingFakerank" class="fakerank-display">
              <!-- Check if user is allowed to use fakeranks -->
              <div *ngIf="fakerankAllowed">
                <div class="nickname-container mb-4">
                  <div
                    class="nickname-preview"
                    [class.nickname-empty]="!currentFakerank"
                  >
                    <div *ngIf="currentFakerank" class="nickname-display">
                      <div class="nickname-icon">âœ¨</div>
                      <div class="nickname-text">
                        <span class="nickname-label">Dein Spitzname:</span>
                        <span
                          class="nickname-value"
                          [style.color]="getColorHex(currentFakerankColor)"
                          >{{ currentFakerank }}</span
                        >
                        <div class="nickname-color-info">
                          <span
                            class="color-indicator"
                            [style.background-color]="
                              getColorHex(currentFakerankColor)
                            "
                          ></span>
                          {{ getColorName(currentFakerankColor) }}
                        </div>
                      </div>
                    </div>
                    <div *ngIf="!currentFakerank" class="nickname-empty-state">
                      <div class="nickname-icon">ğŸ’­</div>
                      <div class="nickname-text">
                        <span class="nickname-label">Noch kein Spitzname</span>
                        <span class="nickname-subtitle"
                          >Gib dir einen coolen Namen!</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
                <div class="fakerank-actions">
                  <button
                    (click)="startEditingFakerank()"
                    class="fakerank-btn fakerank-btn-primary"
                    [disabled]="fakerankLoading"
                  >
                    {{ currentFakerank ? 'âœï¸ Ã„ndern' : 'â• Erstellen' }}
                  </button>
                  <button
                    *ngIf="currentFakerank"
                    (click)="deleteFakerank()"
                    class="fakerank-btn fakerank-btn-danger"
                    [disabled]="fakerankLoading"
                  >
                    ğŸ—‘ï¸ LÃ¶schen
                  </button>

                  <!-- Admin Button -->
                  <button
                    *ngIf="isFakerankAdmin()"
                    [routerLink]="['/fakerank']"
                    class="fakerank-btn fakerank-btn-admin"
                    title="Fakerank Administration"
                  >
                    ğŸ›¡ï¸ Admin Panel
                  </button>

                  <!-- Disabled Admin Button for non-admins (optional visual indicator) -->
                  <button
                    *ngIf="!isFakerankAdmin()"
                    class="fakerank-btn fakerank-btn-admin-disabled"
                    disabled
                    title="Nur fÃ¼r Fakerank-Administratoren verfÃ¼gbar"
                  >
                    ğŸ›¡ï¸ Admin Panel
                  </button>
                </div>
              </div>

              <!-- Not allowed message -->
              <div *ngIf="!fakerankAllowed" class="fakerank-not-allowed">
                <div class="not-allowed-icon">ğŸ”’</div>
                <div class="not-allowed-message">
                  <p class="not-allowed-title">Noch nicht freigeschaltet!</p>
                  <p class="not-allowed-text">
                    Du bist noch nicht fÃ¼r diese Zeitvertreib-Funktion
                    freigeschaltet! Du kannst entweder den Discord-Server
                    <strong>boosten</strong>, Ã¼ber
                    <strong style="white-space: nowrap">ko-fi.com</strong>
                    spenden oder durch sehr aktives Spielen auf dem SCP-Server
                    <strong>VIP</strong> werden.
                  </p>
                  <p class="not-allowed-link">
                    Tritt dem Discord unter
                    <a href="https://dsc.gg/zeit" style="text-decoration: none"
                      ><strong>dsc.gg/zeit</strong></a
                    >
                    bei fÃ¼r weitere Informationen.
                  </p>
                </div>
              </div>
            </div>

            <!-- Edit Mode -->
            <div
              *ngIf="isEditingFakerank && fakerankAllowed"
              class="fakerank-edit"
            >
              <div class="nickname-editor mb-4">
                <label class="editor-label"> âœ¨ Dein neuer Spitzname </label>
                <div class="fakerank-input-container">
                  <input
                    type="text"
                    [(ngModel)]="fakerankValue"
                    placeholder="z.B. Pizza Liebhaber, Sniper Pro, Chaos KÃ¶nig..."
                    maxlength="50"
                    class="nickname-input"
                    [disabled]="fakerankLoading"
                    [style.color]="getColorHex(tempFakerankColor)"
                    (keydown)="onKeyDown($event)"
                    (keyup.enter)="saveFakerank()"
                    (keyup.escape)="cancelEditingFakerank()"
                  />
                  <div class="fakerank-char-count">
                    {{ fakerankValue.length }}/50
                  </div>
                </div>

                <!-- Color Picker Section -->
                <div class="color-picker-section mt-3">
                  <label class="editor-label">ğŸ¨ Farbe wÃ¤hlen</label>
                  <div class="color-picker-container">
                    <button
                      (click)="toggleColorPicker()"
                      class="color-selector-button"
                      [disabled]="fakerankLoading"
                    >
                      <span
                        class="color-indicator"
                        [style.background-color]="
                          getColorHex(tempFakerankColor)
                        "
                      ></span>
                      {{ getColorName(tempFakerankColor) }}
                      <span class="dropdown-arrow">{{
                        showColorPicker ? 'â–²' : 'â–¼'
                      }}</span>
                    </button>

                    <div *ngIf="showColorPicker" class="color-picker-dropdown">
                      <div class="color-options">
                        <button
                          *ngFor="let color of fakerankColors"
                          (click)="selectColor(color.key)"
                          class="color-option"
                          [class.selected]="tempFakerankColor === color.key"
                        >
                          <span
                            class="color-indicator"
                            [style.background-color]="color.hex"
                          ></span>
                          <span class="color-name">{{ color.name }}</span>
                          <span
                            *ngIf="tempFakerankColor === color.key"
                            class="selected-check"
                            >âœ“</span
                          >
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="editor-hint">
                  ğŸ’¡ Sei kreativ! Dies ist nur ein Spitzname zur Dekoration.
                </div>
              </div>
              <div class="fakerank-actions">
                <button
                  (click)="saveFakerank()"
                  class="fakerank-btn fakerank-btn-success"
                  [disabled]="
                    fakerankLoading || fakerankValue.trim().length === 0
                  "
                >
                  {{ fakerankLoading ? 'ğŸ’¾ Speichern...' : 'ğŸ’¾ Speichern' }}
                </button>
                <button
                  (click)="cancelEditingFakerank()"
                  class="fakerank-btn fakerank-btn-secondary"
                  [disabled]="fakerankLoading"
                >
                  âŒ Abbrechen
                </button>
              </div>
            </div>

            <!-- Success Message -->
            <div
              *ngIf="fakerankSuccess"
              class="fakerank-message fakerank-success mt-3"
            >
              ğŸ‰ Spitzname erfolgreich gespeichert!
            </div>

            <!-- Error Message -->
            <div
              *ngIf="fakerankError"
              class="fakerank-message fakerank-error mt-3"
            >
              {{ fakerankError }}
            </div>
          </div>
        </div>
      </div>

      <!-- Session History -->
      <div class="col-span-2 history-container">
        <div class="stats-card p-6 rounded-2xl">
          <div class="flex justify-between items-center mb-4 cardHeader">
            <h3 class="text-2xl font-bold text-white cardHeader">
              Verlauf & Sitzungen
            </h3>
            <button (click)="refreshStats()" class="refresh-button">
              Aktualisieren
            </button>
          </div>
          <div class="chart-placeholder">
            <div class="text-6xl mb-4">ğŸ“ˆ</div>
            <p class="text-lg">KÃ¼rzliche Sitzungen und Verlauf</p>
            <p class="text-sm mt-2 opacity-75">
              Detaillierte Spielverlaufsdaten werden hier angezeigt
            </p>
          </div>
        </div>
      </div>

      <!-- Last Killers -->
      <div class="col-span-1 killers-container">
        <div class="stats-card p-6 rounded-2xl">
          <h3 class="text-xl font-bold text-white mb-4 cardHeader">
            Diese Leute haben dich getÃ¶tet!
          </h3>

          <div *ngIf="!hasKillers" class="text-center py-8">
            <div class="text-4xl mb-4">ğŸ¯</div>
            <p class="text-gray-300">Noch keine Killer-Daten verfÃ¼gbar</p>
          </div>

          <div *ngIf="hasKillers" class="killers-list">
            <div
              *ngFor="
                let killer of userStatistics?.lastkillers;
                let i = index;
                trackBy: trackByKiller
              "
              class="killer-item"
            >
              <img
                class="killer-avatar"
                [src]="getAvatarUrl(killer?.avatarmedium)"
                [alt]="killer?.displayname || 'Unknown Player'"
                loading="lazy"
                (error)="onImageError($event)"
              />
              <div class="flex-1 min-w-0">
                <p class="killer-name" [title]="killer?.displayname">
                  {{ truncateDisplayName(killer?.displayname) }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</div>
