{
  "openapi": "3.0.3",
  "info": {
    "title": "Zeitvertreib Backend API",
    "description": "Backend API for the Zeitvertreib gaming platform, handling authentication, player data, sprays, fakeranks, and financial transactions.",
    "version": "1.0.0",
    "contact": {
      "name": "Zeitvertreib Team",
      "url": "https://github.com/AlexInABox/zeitvertreib-website"
    }
  },
  "servers": [
    {
      "url": "https://dev.zeitvertreib.vip/api",
      "description": "Production server"
    },
    {
      "url": "http://localhost:8787",
      "description": "Development server"
    }
  ],
  "security": [
    {
      "cookieAuth": []
    }
  ],
  "paths": {
    "/auth/steam": {
      "get": {
        "summary": "Initiate Steam login",
        "description": "Redirects to Steam OpenID login page",
        "tags": ["Authentication"],
        "responses": {
          "302": {
            "description": "Redirect to Steam login",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string",
                  "format": "uri"
                },
                "description": "Steam OpenID login URL"
              }
            }
          }
        }
      }
    },
    "/auth/steam/callback": {
      "get": {
        "summary": "Steam login callback",
        "description": "Handles callback from Steam OpenID authentication",
        "tags": ["Authentication"],
        "parameters": [
          {
            "name": "openid.mode",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "openid.identity",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Authentication successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid Steam response"
          },
          "401": {
            "description": "Authentication failed"
          }
        }
      }
    },
    "/auth/me": {
      "get": {
        "summary": "Get current user information",
        "description": "Returns information about the currently authenticated user",
        "tags": ["Authentication"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "User information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionData"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "summary": "Logout user",
        "description": "Invalidates the current session",
        "tags": ["Authentication"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Logout successful"
          }
        }
      }
    },
    "/auth/generate-login-secret": {
      "post": {
        "summary": "Generate login secret for external authentication",
        "description": "Creates a temporary secret for logging in from external applications",
        "tags": ["Authentication"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Login secret generated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "secret": {
                      "type": "string",
                      "description": "Temporary login secret"
                    },
                    "expiresAt": {
                      "type": "number",
                      "description": "Expiration timestamp"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/auth/login-with-secret": {
      "get": {
        "summary": "Login using secret",
        "description": "Authenticate using a previously generated secret",
        "tags": ["Authentication"],
        "parameters": [
          {
            "name": "secret",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Login secret"
          }
        ],
        "responses": {
          "200": {
            "description": "Login successful"
          },
          "400": {
            "description": "Invalid or expired secret"
          }
        }
      }
    },
    "/stats": {
      "get": {
        "summary": "Get player statistics",
        "description": "Returns comprehensive player statistics and game data",
        "tags": ["Statistics"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Player statistics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "stats": {
                      "$ref": "#/components/schemas/Statistics"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/spray/upload": {
      "post": {
        "summary": "Upload custom spray",
        "description": "Upload a custom spray image (moderated by AI)",
        "tags": ["Sprays"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Image file (JPEG, PNG, WebP, max 10MB)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Spray uploaded successfully"
          },
          "400": {
            "description": "Invalid file format or size"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Spray rejected by moderation"
          },
          "429": {
            "description": "Upload limit exceeded"
          }
        }
      }
    },
    "/spray/remove-background": {
      "post": {
        "summary": "Remove background from image",
        "description": "Removes background from uploaded image using AI",
        "tags": ["Sprays"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Background removed successfully",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Invalid image"
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/spray/image": {
      "get": {
        "summary": "Get spray image",
        "description": "Retrieve a spray image by Steam ID",
        "tags": ["Sprays"],
        "parameters": [
          {
            "name": "steamid",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Spray image",
            "content": {
              "image/*": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Spray not found"
          }
        }
      }
    },
    "/spray/string": {
      "get": {
        "summary": "Get spray as base64 string",
        "description": "Retrieve a spray image as base64 encoded string",
        "tags": ["Sprays"],
        "parameters": [
          {
            "name": "steamid",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Base64 encoded spray image",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "spray": {
                      "type": "string",
                      "description": "Base64 encoded image"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Spray not found"
          }
        }
      }
    },
    "/spray/delete": {
      "delete": {
        "summary": "Delete own spray",
        "description": "Delete your own spray image",
        "tags": ["Sprays"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Spray deleted successfully"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Spray not found"
          }
        }
      }
    },
    "/spray/moderate/delete": {
      "delete": {
        "summary": "Moderate spray (admin only)",
        "description": "Delete a spray as a moderator",
        "tags": ["Sprays", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Spray moderated successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/spray/moderate/ban": {
      "post": {
        "summary": "Ban user from uploading sprays (admin only)",
        "description": "Ban a user from uploading sprays",
        "tags": ["Sprays", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User banned successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/spray/moderate/unban": {
      "post": {
        "summary": "Unban user from uploading sprays (admin only)",
        "description": "Remove spray upload ban from user",
        "tags": ["Sprays", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User unbanned successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/spray/moderate/undelete": {
      "post": {
        "summary": "Restore deleted spray (admin only)",
        "description": "Restore a previously deleted spray",
        "tags": ["Sprays", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Spray restored successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/spray/upload-limits": {
      "get": {
        "summary": "Get spray upload limits",
        "description": "Returns current upload limits and user's remaining quota",
        "tags": ["Sprays"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Upload limits information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "maxOriginalSize": {
                      "type": "integer"
                    },
                    "maxThumbnailSize": {
                      "type": "integer"
                    },
                    "supportedFormats": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "remainingUploads": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/spray/ban-status": {
      "get": {
        "summary": "Check spray ban status",
        "description": "Check if user is banned from uploading sprays",
        "tags": ["Sprays"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Ban status information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "isBanned": {
                      "type": "boolean"
                    },
                    "banReason": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/fakerank": {
      "get": {
        "summary": "Get current fakerank",
        "description": "Get the current user's fakerank",
        "tags": ["Fakerank"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Current fakerank",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "fakerank": {
                      "type": "string"
                    },
                    "color": {
                      "type": "string"
                    },
                    "expiresAt": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      },
      "post": {
        "summary": "Set fakerank",
        "description": "Set or update user's fakerank (requires fakerank access)",
        "tags": ["Fakerank"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fakerank": {
                    "type": "string",
                    "maxLength": 50
                  },
                  "color": {
                    "type": "string",
                    "pattern": "^#[0-9A-Fa-f]{6}$"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fakerank updated successfully"
          },
          "400": {
            "description": "Invalid fakerank or profanity detected"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "No fakerank access"
          }
        }
      },
      "patch": {
        "summary": "Update fakerank",
        "description": "Update user's fakerank (alias for POST)",
        "tags": ["Fakerank"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "fakerank": {
                    "type": "string",
                    "maxLength": 50
                  },
                  "color": {
                    "type": "string",
                    "pattern": "^#[0-9A-Fa-f]{6}$"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fakerank updated successfully"
          },
          "400": {
            "description": "Invalid fakerank or profanity detected"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "No fakerank access"
          }
        }
      },
      "delete": {
        "summary": "Delete fakerank",
        "description": "Remove user's current fakerank",
        "tags": ["Fakerank"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Fakerank deleted successfully"
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/fakerank/moderate/delete": {
      "delete": {
        "summary": "Moderate fakerank (admin only)",
        "description": "Delete a user's fakerank and add it to blacklist",
        "tags": ["Fakerank", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fakerank",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Fakerank moderated successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/fakerank/moderate/ban": {
      "post": {
        "summary": "Ban user from fakerank system (admin only)",
        "description": "Ban a user from using fakeranks",
        "tags": ["Fakerank", "Moderation"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User banned from fakerank successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/fakerank-admin/user": {
      "get": {
        "summary": "Get user fakerank info (admin only)",
        "description": "Get detailed fakerank information for a specific user",
        "tags": ["Fakerank Admin"],
        "parameters": [
          {
            "name": "steamId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User fakerank information"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "post": {
        "summary": "Set user fakerank (admin only)",
        "description": "Set or override a user's fakerank as admin",
        "tags": ["Fakerank Admin"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "steamId": {
                    "type": "string"
                  },
                  "fakerank": {
                    "type": "string"
                  },
                  "color": {
                    "type": "string"
                  },
                  "duration": {
                    "type": "integer",
                    "description": "Duration in days"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fakerank set successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/fakerank-admin/blacklist": {
      "get": {
        "summary": "Get fakerank blacklist (admin only)",
        "description": "Get list of blacklisted fakerank terms",
        "tags": ["Fakerank Admin"],
        "responses": {
          "200": {
            "description": "Blacklist entries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "blacklist": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "post": {
        "summary": "Add to fakerank blacklist (admin only)",
        "description": "Add a term to the fakerank blacklist",
        "tags": ["Fakerank Admin"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "term": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Term added to blacklist"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "delete": {
        "summary": "Remove from fakerank blacklist (admin only)",
        "description": "Remove a term from the fakerank blacklist",
        "tags": ["Fakerank Admin"],
        "parameters": [
          {
            "name": "term",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Term removed from blacklist"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/fakerank-admin/whitelist": {
      "get": {
        "summary": "Get fakerank whitelist (admin only)",
        "description": "Get list of whitelisted fakerank terms",
        "tags": ["Fakerank Admin"],
        "responses": {
          "200": {
            "description": "Whitelist entries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "whitelist": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "post": {
        "summary": "Add to fakerank whitelist (admin only)",
        "description": "Add a term to the fakerank whitelist",
        "tags": ["Fakerank Admin"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "term": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Term added to whitelist"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      },
      "delete": {
        "summary": "Remove from fakerank whitelist (admin only)",
        "description": "Remove a term from the fakerank whitelist",
        "tags": ["Fakerank Admin"],
        "parameters": [
          {
            "name": "term",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Term removed from whitelist"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/fakerank-admin/all-fakeranks": {
      "get": {
        "summary": "Get all fakeranks (admin only)",
        "description": "Get all active fakeranks in the system",
        "tags": ["Fakerank Admin"],
        "responses": {
          "200": {
            "description": "All fakeranks",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "fakeranks": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "steamId": {
                            "type": "string"
                          },
                          "fakerank": {
                            "type": "string"
                          },
                          "color": {
                            "type": "string"
                          },
                          "expiresAt": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    },
    "/financial/transactions": {
      "get": {
        "summary": "Get financial transactions",
        "description": "Get list of financial transactions with optional filtering",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 100
            }
          },
          {
            "name": "offset",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 0
            }
          },
          {
            "name": "type",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": ["income", "expense"]
            }
          },
          {
            "name": "category",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of transactions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "transactions": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/FinancialTransaction"
                      }
                    },
                    "total": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      },
      "post": {
        "summary": "Create financial transaction (admin only)",
        "description": "Create a new financial transaction",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FinancialTransactionInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Transaction created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FinancialTransaction"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          }
        }
      },
      "put": {
        "summary": "Update financial transaction (admin only)",
        "description": "Update an existing financial transaction",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FinancialTransaction"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transaction updated successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          },
          "404": {
            "description": "Transaction not found"
          }
        }
      },
      "delete": {
        "summary": "Delete financial transaction (admin only)",
        "description": "Delete a financial transaction by ID",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Transaction deleted successfully"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          },
          "404": {
            "description": "Transaction not found"
          }
        }
      }
    },
    "/financial/recurring": {
      "get": {
        "summary": "Get recurring transactions",
        "description": "Get list of recurring transactions",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "parameters": [
          {
            "name": "active",
            "in": "query",
            "schema": {
              "type": "boolean"
            },
            "description": "Filter by active status"
          }
        ],
        "responses": {
          "200": {
            "description": "List of recurring transactions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "transactions": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/RecurringTransaction"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      },
      "post": {
        "summary": "Create recurring transaction (admin only)",
        "description": "Create a new recurring transaction",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecurringTransactionInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Recurring transaction created successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          }
        }
      },
      "put": {
        "summary": "Update recurring transaction (admin only)",
        "description": "Update an existing recurring transaction",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecurringTransaction"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Recurring transaction updated successfully"
          },
          "400": {
            "description": "Invalid input"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          },
          "404": {
            "description": "Recurring transaction not found"
          }
        }
      },
      "delete": {
        "summary": "Delete recurring transaction (admin only)",
        "description": "Delete a recurring transaction by ID",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurring transaction deleted successfully"
          },
          "401": {
            "description": "Not authenticated"
          },
          "403": {
            "description": "Not authorized (admin only)"
          },
          "404": {
            "description": "Recurring transaction not found"
          }
        }
      }
    },
    "/financial/summary": {
      "get": {
        "summary": "Get financial summary",
        "description": "Get financial summary including totals and category breakdowns",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "parameters": [
          {
            "name": "start_date",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          },
          {
            "name": "end_date",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Financial summary",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalIncome": {
                      "type": "number"
                    },
                    "totalExpenses": {
                      "type": "number"
                    },
                    "netIncome": {
                      "type": "number"
                    },
                    "categoryBreakdown": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "number"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/redeemables": {
      "get": {
        "summary": "Get available redeemables",
        "description": "Get list of items that can be redeemed with ZV Coins",
        "tags": ["Redeemables"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "List of redeemable items",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "redeemables": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Redeemable"
                      }
                    },
                    "userBalance": {
                      "type": "integer",
                      "description": "User's current ZV Coin balance"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/redeemables/redeem": {
      "post": {
        "summary": "Redeem item",
        "description": "Redeem an item using ZV Coins",
        "tags": ["Redeemables"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "itemId": {
                    "type": "string"
                  }
                },
                "required": ["itemId"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Item redeemed successfully"
          },
          "400": {
            "description": "Invalid item or insufficient balance"
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/redeem-code": {
      "post": {
        "summary": "Redeem code",
        "description": "Redeem a special code for ZV Coins",
        "tags": ["Redeemables"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string"
                  }
                },
                "required": ["code"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Code redeemed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "credits": {
                      "type": "integer",
                      "description": "Credits awarded"
                    },
                    "newBalance": {
                      "type": "integer",
                      "description": "New ZV Coin balance"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired code"
          },
          "401": {
            "description": "Not authenticated"
          }
        }
      }
    },
    "/transfer-zvc": {
      "post": {
        "summary": "Transfer ZV Coins",
        "description": "Transfer ZV Coins to another player",
        "tags": ["Financial"],
        "security": [{ "cookieAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "targetSteamId": {
                    "type": "string"
                  },
                  "amount": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "reason": {
                    "type": "string",
                    "maxLength": 200
                  }
                },
                "required": ["targetSteamId", "amount"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transfer successful"
          },
          "400": {
            "description": "Invalid amount or insufficient balance"
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "Target player not found"
          }
        }
      }
    },
    "/leaderboard/update": {
      "post": {
        "summary": "Update leaderboard",
        "description": "Trigger leaderboard update (admin only)",
        "tags": ["Leaderboard"],
        "security": [{ "cookieAuth": [] }],
        "responses": {
          "200": {
            "description": "Leaderboard updated successfully"
          },
          "403": {
            "description": "Not authorized"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "cookieAuth": {
        "type": "apiKey",
        "in": "cookie",
        "name": "session"
      }
    },
    "schemas": {
      "SteamUser": {
        "type": "object",
        "properties": {
          "steamid": {
            "type": "string",
            "description": "Steam ID"
          },
          "personaname": {
            "type": "string",
            "description": "Display name"
          },
          "profileurl": {
            "type": "string",
            "format": "uri",
            "description": "Steam profile URL"
          },
          "avatar": {
            "type": "string",
            "format": "uri",
            "description": "Small avatar URL"
          },
          "avatarmedium": {
            "type": "string",
            "format": "uri",
            "description": "Medium avatar URL"
          },
          "avatarfull": {
            "type": "string",
            "format": "uri",
            "description": "Full avatar URL"
          }
        },
        "required": ["steamid", "personaname", "profileurl", "avatar", "avatarmedium", "avatarfull"]
      },
      "SessionData": {
        "type": "object",
        "properties": {
          "steamId": {
            "type": "string",
            "description": "User's Steam ID"
          },
          "steamUser": {
            "$ref": "#/components/schemas/SteamUser"
          },
          "createdAt": {
            "type": "number",
            "description": "Session creation timestamp"
          },
          "expiresAt": {
            "type": "number",
            "description": "Session expiration timestamp"
          }
        },
        "required": ["steamId", "steamUser", "createdAt", "expiresAt"]
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "session": {
            "$ref": "#/components/schemas/SessionData"
          }
        }
      },
      "Statistics": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "kills": {
            "type": "integer"
          },
          "deaths": {
            "type": "integer"
          },
          "experience": {
            "type": "integer",
            "description": "ZV Coins (legacy name for compatibility)"
          },
          "playtime": {
            "type": "integer",
            "description": "Playtime in seconds"
          },
          "avatarFull": {
            "type": "string",
            "format": "uri"
          },
          "roundsplayed": {
            "type": "integer"
          },
          "leaderboardposition": {
            "type": "integer"
          },
          "usedmedkits": {
            "type": "integer"
          },
          "usedcolas": {
            "type": "integer"
          },
          "pocketescapes": {
            "type": "integer"
          },
          "usedadrenaline": {
            "type": "integer"
          },
          "snakehighscore": {
            "type": "integer"
          },
          "fakerank_until": {
            "type": "number",
            "description": "Fakerank expiration timestamp"
          },
          "fakerankadmin_until": {
            "type": "number",
            "description": "Fakerank admin expiration timestamp"
          },
          "fakerankoverride_until": {
            "type": "number",
            "description": "Admin-set fakerank override expiration timestamp"
          },
          "lastkillers": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "displayname": {
                  "type": "string"
                },
                "avatarmedium": {
                  "type": "string",
                  "format": "uri"
                }
              }
            }
          },
          "lastkills": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "displayname": {
                  "type": "string"
                },
                "avatarmedium": {
                  "type": "string",
                  "format": "uri"
                }
              }
            }
          }
        },
        "required": [
          "username",
          "kills",
          "deaths",
          "experience",
          "playtime",
          "avatarFull",
          "roundsplayed",
          "leaderboardposition"
        ]
      },
      "FinancialTransaction": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "transaction_type": {
            "type": "string",
            "enum": ["income", "expense"]
          },
          "category": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "description": {
            "type": "string"
          },
          "transaction_date": {
            "type": "string",
            "format": "date"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string"
          },
          "reference_id": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        },
        "required": ["transaction_type", "category", "amount", "description", "transaction_date"]
      },
      "FinancialTransactionInput": {
        "type": "object",
        "properties": {
          "transaction_type": {
            "type": "string",
            "enum": ["income", "expense"]
          },
          "category": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "description": {
            "type": "string"
          },
          "transaction_date": {
            "type": "string",
            "format": "date"
          },
          "reference_id": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        },
        "required": ["transaction_type", "category", "amount", "description", "transaction_date"]
      },
      "RecurringTransaction": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "transaction_type": {
            "type": "string",
            "enum": ["income", "expense"]
          },
          "category": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "description": {
            "type": "string"
          },
          "frequency": {
            "type": "string",
            "enum": ["daily", "weekly", "monthly", "yearly"]
          },
          "start_date": {
            "type": "string",
            "format": "date"
          },
          "end_date": {
            "type": "string",
            "format": "date"
          },
          "next_execution": {
            "type": "string",
            "format": "date"
          },
          "is_active": {
            "type": "boolean"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by": {
            "type": "string"
          },
          "reference_id": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          },
          "last_executed": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "transaction_type",
          "category",
          "amount",
          "description",
          "frequency",
          "start_date",
          "next_execution"
        ]
      },
      "RecurringTransactionInput": {
        "type": "object",
        "properties": {
          "transaction_type": {
            "type": "string",
            "enum": ["income", "expense"]
          },
          "category": {
            "type": "string"
          },
          "amount": {
            "type": "number"
          },
          "description": {
            "type": "string"
          },
          "frequency": {
            "type": "string",
            "enum": ["daily", "weekly", "monthly", "yearly"]
          },
          "start_date": {
            "type": "string",
            "format": "date"
          },
          "end_date": {
            "type": "string",
            "format": "date"
          },
          "is_active": {
            "type": "boolean",
            "default": true
          },
          "reference_id": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          }
        },
        "required": ["transaction_type", "category", "amount", "description", "frequency", "start_date"]
      },
      "Redeemable": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "emoji": {
            "type": "string"
          },
          "price": {
            "type": "integer",
            "description": "Price in ZV Coins"
          },
          "redeemableuntil": {
            "type": "string",
            "format": "date-time",
            "description": "Optional expiration date"
          },
          "isExpired": {
            "type": "boolean"
          },
          "availabilityStatus": {
            "type": "string",
            "enum": ["available", "expired", "sold_out"]
          }
        },
        "required": ["id", "name", "description", "emoji", "price"]
      }
    }
  },
  "tags": [
    {
      "name": "Authentication",
      "description": "Steam-based authentication system"
    },
    {
      "name": "Statistics",
      "description": "Player statistics and game data"
    },
    {
      "name": "Sprays",
      "description": "Custom spray image management"
    },
    {
      "name": "Fakerank",
      "description": "Custom rank system for players"
    },
    {
      "name": "Fakerank Admin",
      "description": "Administrative controls for fakerank system"
    },
    {
      "name": "Financial",
      "description": "Financial transaction management"
    },
    {
      "name": "Redeemables",
      "description": "ZV Coin redemption system"
    },
    {
      "name": "Leaderboard",
      "description": "Player ranking and leaderboard"
    },
    {
      "name": "Moderation",
      "description": "Content moderation tools"
    }
  ]
}
